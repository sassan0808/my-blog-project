import { createBlogPost, getOrCreateAuthor, createCategory } from '../lib/sanity-write'
import { client } from '../lib/sanity-node'

async function main() {
  try {
    console.log('ğŸš€ ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’ä½œæˆã—ã¾ã™...')
    
    // å®Ÿéš›ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’å–å¾—
    let categories = []
    try {
      const query = `*[_type == "category"] | order(title asc) {
        _id,
        title,
        description
      }`
      categories = await client.fetch(query)
      console.log('ğŸ“ åˆ©ç”¨å¯èƒ½ãªã‚«ãƒ†ã‚´ãƒªãƒ¼:', categories)
    } catch (error) {
      console.log('ã‚«ãƒ†ã‚´ãƒªãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼:', error)
    }
    
    // ã‚«ãƒ†ã‚´ãƒªãƒ¼ãŒãªã„å ´åˆã¯ä½œæˆ
    if (categories.length === 0) {
      console.log('ğŸ“‚ ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’ä½œæˆã—ã¾ã™...')
      const aiCategory = await createCategory('AIæ´»ç”¨', 'AIæŠ€è¡“ã®æ´»ç”¨æ–¹æ³•ã‚„ãƒˆãƒ¬ãƒ³ãƒ‰')
      categories = [aiCategory]
    }
    
    // è‘—è€…ã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
    const authorId = await getOrCreateAuthor('Claude AI Assistant')
    
    // ãƒ–ãƒ­ã‚°è¨˜äº‹ã®å†…å®¹
    const blogPost = {
      title: 'ãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§å¤‰ã‚ã‚‹é–‹ç™ºä½“é¨“ï¼šãƒãƒ£ãƒƒãƒˆã ã‘ã§ãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ãŸè©±',
      content: `ä»Šæ—¥ã¯ã€Claude AIã‚’ä½¿ã£ãŸã€Œãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã§ã€ã“ã®ãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ãŸä½“é¨“ã‚’ã‚·ã‚§ã‚¢ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

ãªã‚“ã¨ã€ç®¡ç†ç”»é¢ã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚‚ã€ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ‡ã‚£ã‚¿ã‚‚ä¸€åˆ‡ä½¿ã‚ãšã«ã€ãƒãƒ£ãƒƒãƒˆã ã‘ã§ã‚«ãƒ†ã‚´ãƒªãƒ¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã§ãã¦ã—ã¾ã„ã¾ã—ãŸï¼

## ãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ã¯ï¼Ÿ

ãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ã€AIã¨ã®å¯¾è©±ã‚’é€šã˜ã¦ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»ç·¨é›†ã™ã‚‹æ–°ã—ã„é–‹ç™ºã‚¹ã‚¿ã‚¤ãƒ«ã§ã™ã€‚ã€Œã“ã‚“ãªæ„Ÿã˜ã§ä½œã£ã¦ã€ã¨ã„ã†è¦æœ›ã‚’ä¼ãˆã‚‹ã ã‘ã§ã€AIãŒé©åˆ‡ãªã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¦ãã‚Œã¾ã™ã€‚

## å®Ÿéš›ã«ã§ããŸã“ã¨

ä»Šå›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸæ©Ÿèƒ½ï¼š
- Sanityã¨ã®å®Œå…¨çµ±åˆ
- ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«ã‚ˆã‚‹è¨˜äº‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãªUIãƒ‡ã‚¶ã‚¤ãƒ³
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ

ã™ã¹ã¦ã€Œä¼šè©±ã€ã ã‘ã§å®Œæˆã—ã¾ã—ãŸã€‚

## é–‹ç™ºåŠ¹ç‡ã®é©å‘½

å¾“æ¥ãªã‚‰æ•°æ™‚é–“ã‹ã‹ã£ã¦ã„ãŸä½œæ¥­ãŒã€ã‚ãšã‹æ•°åˆ†ã§å®Œäº†ã€‚ã—ã‹ã‚‚ã€TypeScriptã®å‹å®šç¾©ã‚„ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¾ã§ã€ã—ã£ã‹ã‚Šã¨å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ä»Šå¾Œã®å±•æœ›

ãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ã€éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã‚‚é«˜å“è³ªãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚Œã‚‹æ™‚ä»£ã®åˆ°æ¥ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã‚¢ã‚¤ãƒ‡ã‚¢ã•ãˆã‚ã‚Œã°ã€èª°ã§ã‚‚è‡ªåˆ†ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã™ã€‚

ã“ã®ãƒ–ãƒ­ã‚°è‡ªä½“ãŒã€ãƒã‚¤ãƒ–ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®å¯èƒ½æ€§ã‚’è¨¼æ˜ã™ã‚‹ç”ŸããŸä¾‹ã¨ãªã£ã¦ã„ã¾ã™ã€‚`,
      categoryIds: categories.length > 0 ? [categories[0]._id] : [],
      authorId
    }
    
    console.log('ğŸ“ è¨˜äº‹ã‚’æŠ•ç¨¿ä¸­...')
    const result = await createBlogPost(blogPost)
    
    console.log('âœ… è¨˜äº‹ãŒæ­£å¸¸ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸï¼')
    console.log(`ğŸ“Œ è¨˜äº‹ID: ${result._id}`)
    console.log(`ğŸ”— ã‚¹ãƒ©ãƒƒã‚°: ${result.slug.current}`)
    console.log(`ğŸŒ URL: http://localhost:5173/blog/${result.slug.current}`)
    
  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error)
  }
}

// ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
main()